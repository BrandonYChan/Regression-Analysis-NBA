---
title: "Regression Analysis on NBA Claims"
author: "Brandon Chan, Brayden Van De Wynckel"
date: "2024-11-13"
output: html_document
---

```{r setup, include=FALSE} 
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
```

# Objective  
Many older NBA fans like to make claims about how the league was different back in their day. Some common claims are "no-one play defense anymore" and "players only shoot threes nowadays". The aim of this analysis is to test and analyze some of these claims, as well as predict.   

# Data Description 
The data is from basketballreference.com. They offer CSV files that are free to download on their website. This particular dataset includes many common stats (ex. points, offensive rating), taken as the league average of per-game stats of teams for a given season. For example the PTS stat in the 2023-24 season represents that average points per game scored by a team in a single game.
```{r}
league_df <- read.csv("https://raw.githubusercontent.com/BrandonYChan/ballindata/refs/heads/master/static/CSV/League/per100_league.csv")
head(league_df)
```

The following is a breakdown of each category within the dataset.
Rk (Rank): The sequential ranking of each season's data entry.
Season: The specific NBA season (e.g., 2023-24).
Lg (League): The basketball league, typically "NBA".
Age: The average age of players in the league for that season.
Ht (Height): The average height of players, typically represented in feet and inches.
Wt (Weight): The average weight of players in pounds.
G (Games): The total number of games played in the season.
MP (Minutes Played): The average total minutes played per game by all teams combined.
FG (Field Goals): The average number of field goals made per game.
FGA (Field Goal Attempts): The average number of field goal attempts per game.
X3P (3-Point Field Goals): The average number of 3-point field goals made per game.
X3PA (3-Point Attempts): The average number of 3-point field goal attempts per game.
FT (Free Throws): The average number of free throws made per game.
FTA (Free Throw Attempts): The average number of free throw attempts per game.
ORB (Offensive Rebounds): The average number of offensive rebounds per game.
DRB (Defensive Rebounds): The average number of defensive rebounds per game.
TRB (Total Rebounds): The average number of total rebounds (offensive + defensive) per game.
AST (Assists): The average number of assists per game.
STL (Steals): The average number of steals per game.
BLK (Blocks): The average number of blocks per game.
TOV (Turnovers): The average number of turnovers per game.
PF (Personal Fouls): The average number of personal fouls per game.
PTS (Points): The average total points scored per game.
FG% (Field Goal Percentage): The shooting percentage for field goals (FG/FGA).
X3P% (3-Point Percentage): The shooting percentage for 3-point field goals (3P/3PA).
FT% (Free Throw Percentage): The shooting percentage for free throws (FT/FTA).
Pace: The average number of possessions per 48 minutes, indicating the speed of play.
eFG% (Effective Field Goal Percentage): A shooting metric that adjusts for the higher value of 3-point shots, calculated as (FG+0.5*P)/FGA
TOV% (Turnover Percentage): The percentage of possessions ending in turnovers.
ORB% (Offensive Rebound Percentage): The percentage of available offensive rebounds a team secures.
FT/FGA (Free Throw Attempts Per Field Goal Attempt): The ratio of free throw attempts to field goal attempts.
ORtg (Offensive Rating): The number of points scored per 100 possessions.
TS% (True Shooting Percentage): A measure of shooting efficiency that considers field goals, 3-point field goals, and free throws, calculated as PTS/(2*(FGA+0.44*FTA))

# EDA 
```{r}
df_3s <- league_df %>%
  filter(!is.na(Pace), !is.na("3P"), !is.na("3P%")) %>%
  select(Season, "3P", "3P%")

df_3s %>%
  ggplot(aes(Season, "3P", group=1)) + geom_point() + 
  geom_line() +
  scale_x_discrete(breaks=c("1979-80", "1989-90", "1999-00", "2009-10", "2019-20")) +
  ggtitle("3-Pointers Made Per-Game Increases Almost Every Season") +
  labs(caption = "Distance decreased from 1994-1997")

```
## Hypothesis Test:
H0: Mean # 3's in the 2020's = Mean # 3s in the 1990's    HA: Mean # 3's in the 2020's > Mean # 3s in the 1990's 
```{r}
# Group by decade
df_3s <- df_3s %>%
  mutate(Decade = paste(substr(Season, 6, 6), "0's", sep = ""))

# Get mean 3's for each decade
decade3s <- df_3s %>%
  group_by(Decade) %>%
  summarise(Mean3s = mean(`3P`)) %>%
  arrange(desc(Mean3s))
decade3s

mean3s_2020s <- decade3s %>%
  filter(Decade == "20's") %>%
  select(Mean3s) %>%
  pull()

means3s_1990s <- decade3s %>%
  filter(Decade=="90's") %>%
  select(Mean3s) %>%
  pull() 

mu <- mean(decade3s$Mean3s)
sigma <- sd(decade3s$Mean3s)
```

Regress defensive stats against 3 point attempts to see if better defense leads to more 3 point attempts

```{r}
lm_3s <- lm(X3PA~STL+TOV+BLK, league_df)
summary(lm_3s)
```

```{r}
anova(lm_3s)
```

```{r}
confint(lm_3s, level=0.9)
```

```{r}
plot(league_df$STL, league_df$X3PA)
abline(lm(X3PA~STL, league_df))
```

```{r}
plot(league_df$TOV, league_df$X3PA)
abline(lm(X3PA~TOV, league_df))
```

```{r}
plot(league_df$BLK, league_df$X3PA)
abline(lm(X3PA~BLK, league_df))
```

