2, 2, 1, 3, 3, 3,
1, 0, -1, 1, 1, 0,
3, 0, -1, 3, -1, 0),
nrow=4, byrow=TRUE))
# score_change
Y <- as.vector(t(score_change))
X <- matrix(c(rep(1, 24), rep(1, 6), rep(0,18), rep(0, 6), rep(1, 6), rep(0, 12), rep(0, 12), rep(1, 6), rep(0, 6)), ncol=4, byrow=FALSE)
t(x) %*% X
t(X) %*% X
inv(XTX) %*% Y
solve(XTX) %*% Y
score_change <- t(matrix(c(1, 1, 2, 2, 3, 4,
2, 2, 1, 3, 3, 3,
1, 0, -1, 1, 1, 0,
3, 0, -1, 3, -1, 0),
nrow=4, byrow=TRUE))
# score_change
Y <- as.vector(t(score_change))
X <- matrix(c(rep(1, 24), rep(1, 6), rep(0,18), rep(0, 6), rep(1, 6), rep(0, 12), rep(0, 12), rep(1, 6), rep(0, 6)), ncol=4, byrow=FALSE)
XTX <- t(X) %*% X
solve(XTX) %*% Y
solve(XTX)
solve(XTX) %*% Y
XTX <- X %*% t(X)
solve(XTX) %*% Y
X %*% t(X)
X %*% t(X)
X
XTX <- t(X) %*% X
t(X) %*% X
Y
t(X) %*% Y
solve(XTX) %*% t(X) %*% Y
solve(XTX) %*% t(X) %*% Y
B
score_change <- t(matrix(c(1, 1, 2, 2, 3, 4,
2, 2, 1, 3, 3, 3,
1, 0, -1, 1, 1, 0,
3, 0, -1, 3, -1, 0),
nrow=4, byrow=TRUE))
# score_change
Y <- as.vector(t(score_change))
X <- matrix(c(rep(1, 24), rep(1, 6), rep(0,18), rep(0, 6), rep(1, 6), rep(0, 12), rep(0, 12), rep(1, 6), rep(0, 6)), ncol=4, byrow=FALSE)
XTX <- t(X) %*% X
B <- solve(XTX) %*% t(X) %*% Y
B
# (1)
p <- 4
n <- length(score_change[,1])
SSres <- sum(score_change)
matrix(c("Source", "df", "SS", "MS",
"Regression", p, 1, 1,
"Residual", n-(p+1), 1, 1,
"Total", n-1, 1, 1), nrow=4, byrow=TRUE)
X %*% B
Y <- X %*% B
score_change <- t(matrix(c(1, 1, 2, 2, 3, 4,
2, 2, 1, 3, 3, 3,
1, 0, -1, 1, 1, 0,
3, 0, -1, 3, -1, 0),
nrow=4, byrow=TRUE))
# score_change
Y <- as.vector(t(score_change))
X <- matrix(c(rep(1, 24), rep(1, 6), rep(0,18), rep(0, 6), rep(1, 6), rep(0, 12), rep(0, 12), rep(1, 6), rep(0, 6)), ncol=4, byrow=FALSE)
XTX <- t(X) %*% X
B <- solve(XTX) %*% t(X) %*% Y
# Y <- X %*% B
B
SST <- 2 * sum(mean(Y)^2)
Y
SST <- 2 * (2.167+2.333+0.333+0.667)^2
2 * (2.167+2.333+0.333+0.667)^2
SST <- 2 * (2.167+2.333+0.333+0.667)^2 - n*(mean(Y))
2 * (2.167+2.333+0.333+0.667)^2 - n*(mean(Y))
setwd("C:/Users/bchan/OneDrive - Wilfrid Laurier University/ST362/Regression-Analysis-NBA")
knitr::opts_chunk$set(echo = TRUE)
# install.packages("MASS")
# install.packages("leaps")
library(MASS)
library(tidyverse)
library(leaps)
select <- dplyr::select
league_df <- read_csv("https://raw.githubusercontent.com/BrandonYChan/ballindata/refs/heads/master/static/CSV/League/per100_league.csv") %>%
filter(Season >= "1950-51") %>%
select(-c(Rk, Lg))
league_df
# Group by decade
df_3s <- league_df %>%
mutate(Decade = paste(substr(Season, 6, 6), "0's", sep=""))
# Get mean 3's for each decade
decade3s <- df_3s %>%
group_by(Decade) %>%
summarise(Mean3s = mean(`3PA`)) %>%
arrange(desc(Mean3s))
decade3s
mean3s_2020s <- decade3s %>%
filter(Decade=="20's") %>%
select(Mean3s) %>%
pull()
means3s_1990s <- decade3s %>%
filter(Decade=="90's") %>%
select(Mean3s) %>%
pull()
mu <- mean(decade3s$Mean3s)
sigma_1 <- df_3s %>%
filter(Decade=="20's") %>%
summarise(sd(`3PA`)) %>%
pull()
sigma_2 <- df_3s %>%
filter(Decade=="90's") %>%
summarise(sd(`3PA`)) %>%
pull()
n <- df_3s %>%
filter(Decade=="20's") %>%
select(Decade) %>%
count() %>%
pull()
m <- df_3s %>%
filter(Decade=="90's") %>%
select(Decade) %>%
count() %>%
pull()
t_obs <- ((mean3s_2020s - means3s_1990s)-0)/sqrt(sigma_1^2/n + sigma_2^2/m)
t_obs
# Evaluated at 95% significance
# qt(0.05, n-1, lower.tail = FALSE)
df_3s <- league_df %>%
filter(!is.na(Pace), !is.na(`3PA`), !is.na(`3P%`)) %>%
select(Season,`3PA`, `3P%`)
df_3s %>%
ggplot(aes(Season, `3PA`, group=1)) +
geom_point() +
geom_line() +
scale_x_discrete(breaks=c("1979-80", "1989-90", "1999-00", "2009-10", "2019-20")) +
ggtitle("3-Pointers Made Per-Game Increases Almost Every Season") +
labs(caption = "3-pt line distance decreased from 1994 to 1997")
df_pred3 <- league_df %>%
select(-c(Season, Ht, `3P`, `3P%`, FG, FGA, `FG%`, `FT/FGA`, `eFG%` ))
df_pred3
# Maybe add reasons why you chose each of these variables
# result.null <- lm(`3PA` ~ 1, df_pred3)
# result.full <- lm(`3PA` ~ ., df_pred3)
# step(result.null, scope=list(upper=result.full), data=df_pred3, direction="both")
best_subsets_3s <- regsubsets(`3PA`~., df_pred3, method="backward")
best_summary_3s <- summary(best_subsets)
df_pred3 <- league_df %>%
select(-c(Season, Ht, `3P`, `3P%`, FG, FGA, `FG%`, `FT/FGA`, `eFG%` ))
df_pred3
# Maybe add reasons why you chose each of these variables
# result.null <- lm(`3PA` ~ 1, df_pred3)
# result.full <- lm(`3PA` ~ ., df_pred3)
# step(result.null, scope=list(upper=result.full), data=df_pred3, direction="both")
best_subsets_3s <- regsubsets(`3PA`~., df_pred3, method="backward")
best_summary_3s <- summary(best_subsets)
df_pred3 <- league_df %>%
select(-c(Season, Ht, `3P`, `3P%`, FG, FGA, `FG%`, `FT/FGA`, `eFG%` ))
df_pred3
# Maybe add reasons why you chose each of these variables
# result.null <- lm(`3PA` ~ 1, df_pred3)
# result.full <- lm(`3PA` ~ ., df_pred3)
# step(result.null, scope=list(upper=result.full), data=df_pred3, direction="both")
best_subsets_3s <- regsubsets(`3PA`~., df_pred3, method="backward")
best_summary_3s <- summary(best_subsets)
df_pred3 <- league_df %>%
select(-c(Season, Ht, `3P`, `3P%`, FG, FGA, `FG%`, `FT/FGA`, `eFG%` ))
df_pred3
best_subsets_3s <- regsubsets(`3PA`~., df_pred3, method="backward")
best_summary_3s <- summary(best_subsets)
df_pred3 <- league_df %>%
select(-c(Season, Ht, `3P`, `3P%`, FG, FGA, `FG%`, `FT/FGA`, `eFG%` ))
df_pred3
best_subsets_3s <- regsubsets(`3PA`~., df_pred3, method="backward")
best_summary_3s <- summary(best_subsets_3s)
plot(best_summary$bic, xlab = "Number of Variables", ylab = "BIC", type = "b")
df_pred3 <- league_df %>%
select(-c(Season, Ht, `3P`, `3P%`, FG, FGA, `FG%`, `FT/FGA`, `eFG%` ))
df_pred3
best_subsets_3s <- regsubsets(`3PA`~., df_pred3, method="backward")
best_summary_3s <- summary(best_subsets_3s)
plot(best_summary$bic, xlab = "Number of Variables", ylab = "BIC", type = "b")
df_pred3 <- league_df %>%
select(-c(Season, Ht, `3P`, `3P%`, FG, FGA, `FG%`, `FT/FGA`, `eFG%` ))
df_pred3
best_subsets_3s <- regsubsets(`3PA`~., df_pred3, method="backward")
best_summary_3s <- summary(best_subsets_3s)
plot(best_summary_3s$bic, xlab = "Number of Variables", ylab = "BIC", type = "b")
coef(best_subsets_3s, 9)
df_pred3 <- league_df %>%
select(-c(Season, Ht, `3P`, `3P%`, FG, FGA, `FG%`, `FT/FGA`, `eFG%` ))
df_pred3
best_subsets_3s <- regsubsets(`3PA`~., df_pred3, method="backward")
best_summary_3s <- summary(best_subsets_3s)
plot(best_summary_3s$bic, xlab = "Number of Variables", ylab = "BIC", type = "b")
coef(best_subsets_3s, 9)
# Remove
df_pred3 <- league_df %>%
select(-c(Season, Ht, `3P`, `3P%`, FG, FGA, `FG%`, `FT/FGA`, `eFG%` ))
df_pred3
best_subsets_3s <- regsubsets(`3PA`~., df_pred3, method="backward")
best_summary_3s <- summary(best_subsets_3s)
plot(best_summary_3s$bic, xlab = "Number of Variables", ylab = "BIC", type = "b")
coef(best_subsets_3s, 4)
model_3s <- lm(`3PA` ~ DRB+STL+TOV+PTS , df_pred3)
summary(model_3s)
# Remove variables with direct linear dependenvies
df_pred3 <- league_df %>%
select(-c(Season, Ht, `3P`, `3P%`, FG, FGA, `FG%`, `FT/FGA`, `eFG%` ))
df_pred3
best_subsets_3s <- regsubsets(`3PA`~., df_pred3, method="backward")
best_summary_3s <- summary(best_subsets_3s)
plot(best_summary_3s$bic, xlab = "Number of Variables", ylab = "BIC", type = "b")
coef(best_subsets_3s, 4)
lm_defence <- lm(`3PA`~STL+TOV+BLK+DRB, league_df)
summary(lm_3s)
lm_defence <- lm(`3PA`~STL+TOV+BLK+DRB, league_df)
summary(model_3s)
anova(lm_defence)
# Remove variables with direct linear dependenvies
df_pred3 <- league_df %>%
select(-c(Season, Ht, `3P`, `3P%`, FG, FGA, `FG%`, `FT/FGA`, `eFG%` ))
best_subsets_3s <- regsubsets(`3PA`~., df_pred3, method="backward")
best_summary_3s <- summary(best_subsets_3s)
plot(best_summary_3s$bic, xlab = "Number of Variables", ylab = "BIC", type = "b")
coef(best_subsets_3s, 4)
league_df
# Remove variables with direct linear dependenvies
df_pred3 <- league_df %>%
select(-c(Season, Ht, `3P`, `3P%`, FG, FGA, `FG%`, `FT/FGA`, `eFG%` ))
best_subsets_3s <- regsubsets(`3PA`~., df_pred3, method="backward")
best_summary_3s <- summary(best_subsets_3s)
plot(best_summary_3s$bic, xlab = "Number of Variables", ylab = "BIC", type = "b")
# Remove variables with direct linear dependenvies
df_pred3 <- league_df %>%
select(-c(Season, Ht, `3P`, `3P%`, FG, FGA, `FG%`, `FT/FGA`, `eFG%` ))
best_subsets_3s <- regsubsets(`3PA`~., df_pred3, method="backward")
best_summary_3s <- summary(best_subsets_3s)
plot(best_summary_3s$bic, xlab = "Number of Variables", ylab = "BIC", type = "b")
league_df
# Remove variables with direct linear dependenvies
df_pred3 <- league_df %>%
select(-c(Season, Ht, `3P`, `3P%`, FG, FGA, `FG%`, `FT/FGA`, `eFG%`, `TS%`))
best_subsets_3s <- regsubsets(`3PA`~., df_pred3, method="backward")
best_summary_3s <- summary(best_subsets_3s)
plot(best_summary_3s$bic, xlab = "Number of Variables", ylab = "BIC", type = "b")
league_df
# Evaluated at 95% significance
qt(0.05, n-1, lower.tail = FALSE)
coef(best_subsets_3s, 4)
# Remove variables with direct linear dependencies
df_pred3 <- league_df %>%
select(-c(Season, Ht, `3P`, `3P%`, FG, FGA, `FG%`, `FT/FGA`, `eFG%`, `TS%`))
best_subsets_3s <- regsubsets(`3PA`~., df_pred3, method="backward")
best_summary_3s <- summary(best_subsets_3s)
plot(best_summary_3s$bic, xlab = "Number of Variables", ylab = "BIC", type = "b")
# Remove variables with direct linear dependencies
df_pred3 <- league_df %>%
select(-c(Season, Ht, `3P`, `3P%`, FG, FGA, `FG%`, `FT/FGA`, `eFG%`, `TS%`))
best_subsets_3s <- regsubsets(`3PA`~., df_pred3, method="backward")
best_summary_3s <- summary(best_subsets_3s)
plot(best_summary_3s$bic, xlab = "Number of Variables", ylab = "BIC", type = "b")
# Remove variables with direct linear dependencies
df_pred3 <- league_df %>%
select(-c(Season, Ht, `3P`, `3P%`, FG, FGA, `FG%`, `FT/FGA`, `eFG%`, `TS%`))
best_subsets_3s <- regsubsets(`3PA`~., df_pred3, method="backward")
best_summary_3s <- summary(best_subsets_3s)
plot(best_summary_3s$bic, xlab = "Number of Variables", ylab = "BIC", type = "b")
# Remove variables with direct linear dependencies
df_pred3 <- league_df %>%
select(-c(Season, Ht, `3P`, `3P%`, FG, FGA, `FG%`, `FT/FGA`, `eFG%`, `TS%`))
best_subsets_3s <- regsubsets(`3PA`~., df_pred3, method="backward")
best_summary_3s <- summary(best_subsets_3s)
plot(best_summary_3s$bic, xlab = "Number of Variables", ylab = "BIC", type = "b")
best_coefs <- coef(best_subsets_3s, 4)
best_coefs
best_coefs[0]
nams(best_coefs)
names(best_coefs)
model_3s <- lm(`3PA` ~ "DRB"+STL+TOV+PTS , df_pred3)
league_df
# Remove variables with direct linear dependencies
df_pred3 <- league_df %>%
select(-c(Season, Ht, `3P`, `3P%`, FG, FGA, `FG%`, `FT/FGA`, `eFG%`, `TS%`, `Pace))
best_subsets_3s <- regsubsets(`3PA`~., df_pred3, method="backward")
# Remove variables with direct linear dependencies
df_pred3 <- league_df %>%
select(-c(Season, Ht, `3P`, `3P%`, FG, FGA, `FG%`, `FT/FGA`, `eFG%`, `TS%`, `Pace`))
best_subsets_3s <- regsubsets(`3PA`~., df_pred3, method="backward")
best_summary_3s <- summary(best_subsets_3s)
plot(best_summary_3s$bic, xlab = "Number of Variables", ylab = "BIC", type = "b")
# Remove variables with direct linear dependencies
df_pred3 <- league_df %>%
select(-c(Season, Ht, `3P`, `3P%`, FG, FGA, `FG%`, `FT/FGA`, `eFG%`, `TS%`))
best_subsets_3s <- regsubsets(`3PA`~., df_pred3, method="backward")
best_summary_3s <- summary(best_subsets_3s)
plot(best_summary_3s$bic, xlab = "Number of Variables", ylab = "BIC", type = "b")
# Remove variables with direct linear dependencies
df_pred3 <- league_df %>%
select(-c(Season, Ht, `3P`, `3P%`, FG, FGA, `FG%`, `FT/FGA`, `eFG%`, `TS%`))
best_subsets_3s <- regsubsets(`3PA`~., df_pred3, method="forward")
best_summary_3s <- summary(best_subsets_3s)
plot(best_summary_3s$bic, xlab = "Number of Variables", ylab = "BIC", type = "b")
# Remove variables with direct linear dependencies
df_pred3 <- league_df %>%
select(-c(Season, Ht, `3P`, `3P%`, FG, FGA, `FG%`, `FT/FGA`, `eFG%`, `TS%`))
best_subsets_3s <- regsubsets(`3PA`~., df_pred3, method="backward")
best_summary_3s <- summary(best_subsets_3s)
plot(best_summary_3s$bic, xlab = "Number of Variables", ylab = "BIC", type = "b")
best_coefs <- coef(best_subsets_3s, 4)
coef_names <- names(best_coefs)
best_coefs <- coef(best_subsets_3s, 4)
coef_names <- names(best_coefs)
coef_names
# Remove variables with direct linear dependencies
df_pred3 <- league_df %>%
select(-c(Season, Ht, `3P`, `3P%`, FG, FGA, `FG%`, `FT/FGA`, `eFG%`, `TS%`))
best_subsets_3s <- regsubsets(`3PA`~., df_pred3, method="backward")
best_summary_3s <- summary(best_subsets_3s)
plot(best_summary_3s$bic, xlab = "Number of Variables", ylab = "BIC", type = "b")
best_coefs <- coef(best_subsets_3s, 4)
coef_names <- names(best_coefs)
coef_names
best_coefs <- coef(best_subsets_3s, 5)
coef_names <- names(best_coefs)
best_coefs <- coef(best_subsets_3s, 5)
coef_names <- names(best_coefs)
coef_names
model_3s <- lm(`3PA` ~ TRB+STL+TOV+PTS+`ORB%` , df_pred3)
summary(model_3s)
anova(lm_defence)
confint(lm_defence, level=0.95)
plot(league_df$STL, league_df$`3PA`)
abline(lm(`3PA`~STL, league_df))
plot(league_df$TOV, league_df$`3PA`)
abline(lm(`3PA`~TOV, league_df))
plot(league_df$BLK, league_df$`3PA`)
abline(lm(`3PA`~BLK, league_df))
plot(league_df$DRB, league_df$`3PA`)
abline(lm(`3PA`~DRB, league_df))
df_3s <- league_df %>%
filter(!is.na(Pace), !is.na(`3PA`), !is.na(`3P%`)) %>%
select(Season,`3PA`, `3P%`)
df_3s %>%
ggplot(aes(Season, `3PA`, group=1)) +
geom_point() +
geom_line() +
scale_x_discrete(breaks=c("1979-80", "1989-90", "1999-00", "2009-10", "2019-20")) +
ggtitle("3-Pointers Made Per-Game Increases Almost Every Season") +
labs(caption = "3-pt line distance decreased from 1994 to 1997")
df_pred3
best_summary_3s$bic
best_summary_3s$bic %>%
ggplot()
best_summary_3s$bic %>%
ggplot() + geom_point()
best_summary_3s$bic %>%
ggplot() + geom_bar()
best_summary_3s$bic %>%
ggplot(aes(bic)) + geom_bar()
# Remove variables with direct linear dependencies
df_pred3 <- league_df %>%
select(-c(Season, Ht, `3P`, `3P%`, FG, FGA, `FG%`, `FT/FGA`, `eFG%`, `TS%`))
best_subsets_3s <- regsubsets(`3PA`~., df_pred3, method="backward")
best_summary_3s <- summary(best_subsets_3s)
plot(best_summary_3s$bic, xlab = "Number of Variables", ylab = "BIC", type = "b")
best_summary_3s$bic %>%
ggplot(data_frame(.))) + geom_bar()
best_summary_3s$bic %>%
ggplot(data_frame(.))) + geom_bar()
best_summary_3s$bic %>%
ggplot(data_frame(.)) + geom_bar()
best_summary_3s$bic %>%
data_frame(.)
best_summary_3s$bic %>%
ggplot(data_frame(.))
ggplot(data_frame(.), aes('.))
best_summary_3s$bic %>%
ggplot(data_frame(.), aes('.'))
best_summary_3s$bic %>%
ggplot(data_frame(.), aes('.'))
best_summary_3s$bic %>%
ggplot(data.frame(.), aes('.'))
data_frame(best_summary_3s$bic)
data_frame(best_summary_3s$bic)
data_frame(best_summary_3s$bic) %>%
ggplot(, aes(best_summary_3s$bic))
data_frame(best_summary_3s$bic) %>%
ggplot(, aes(best_summary_3s$bic)) + geom_bar
data_frame(best_summary_3s$bic) %>%
ggplot(, aes(best_summary_3s$bic)) + geom_bar()
data_frame(best_summary_3s$bic) %>%
ggplot(, aes(x=best_summary_3s$bic)) + geom_bar()
best_summary_3s$bic
data_frame(best_summary_3s$bic) %>%
ggplot(, aes(x='best_summary_3s$bic')) + geom_bar()
data_frame(best_summary_3s$bic)
data_frame(best_summary_3s$bic) %>%
ggplot(, aes(x='best_summary_3s$bic')) + geom_count()
data_frame(best_summary_3s$bic) %>%
ggplot(, aes(x='best_summary_3s$bic')) + geom_bar()
data_frame(seq(len(best_summary_3s$bic)), best_summary_3s$bic) %>%
ggplot(, aes(x='best_summary_3s$bic')) + geom_bar()
data_frame(seq(length(best_summary_3s$bic)), best_summary_3s$bic) %>%
ggplot(, aes(x='best_summary_3s$bic')) + geom_bar()
data_frame(seq(length(best_summary_3s$bic)), best_summary_3s$bic)
')) + geom_point()
# Remove variables with direct linear dependencies
df_pred3 <- league_df %>%
select(-c(Season, Ht, `3P`, `3P%`, FG, FGA, `FG%`, `FT/FGA`, `eFG%`, `TS%`))
best_subsets_3s <- regsubsets(`3PA`~., df_pred3, method="backward")
best_summary_3s <- summary(best_subsets_3s)
plot(best_summary_3s$bic, xlab = "Number of Variables", ylab = "BIC", type = "b")
data_frame(seq(length(best_summary_3s$bic)), best_summary_3s$bic) %>%
ggplot(, aes(x='best_summary_3s$bic', y='seq(length(best_summary_3s$bic))
plot(best_summary_3s$bic, xlab = "Number of Variables", ylab = "BIC", type = "b")
data_frame(seq(length(best_summary_3s$bic)), best_summary_3s$bic) %>%
ggplot(, aes(x='best_summary_3s$bic', y='seq(length(best_summary_3s$bic))
<int>
')) + geom_point()
# Remove variables with direct linear dependencies
df_pred3 <- league_df %>%
select(-c(Season, Ht, `3P`, `3P%`, FG, FGA, `FG%`, `FT/FGA`, `eFG%`, `TS%`))
best_subsets_3s <- regsubsets(`3PA`~., df_pred3, method="backward")
best_summary_3s <- summary(best_subsets_3s)
plot(best_summary_3s$bic, xlab = "Number of Variables", ylab = "BIC", type = "b")
data_frame(seq(length(best_summary_3s$bic)), best_summary_3s$bic) %>%
ggplot(, aes(x='best_summary_3s$bic', y='seq(length(best_summary_3s$bic))')) + geom_point()
df_3s <- league_df %>%
filter(!is.na(Pace), !is.na(`3PA`), !is.na(`3P%`)) %>%
select(Season,`3PA`, `3P%`)
df_3s %>%
ggplot(aes(Season, `3PA`, group=1)) +
geom_point() +
geom_line() +
scale_x_discrete(breaks=c("1979-80", "1989-90", "1999-00", "2009-10", "2019-20")) +
ggtitle("3-Pointers Made Per-Game Increases Almost Every Season") +
labs(caption = "3-pt line distance decreased from 1994 to 1997")
data_frame(seq(length(best_summary_3s$bic)), best_summary_3s$bic) %>%
ggplot(, aes(x='best_summary_3s$bic', y='seq(length(best_summary_3s$bic))')) + geom_point()
data_frame(seq(length(best_summary_3s$bic)), best_summary_3s$bic) %>%
ggplot(, aes(x=`best_summary_3s$bic`, y=`seq(length(best_summary_3s$bic))`)) + geom_point()
data_frame(seq(length(best_summary_3s$bic)), best_summary_3s$bic)
ggplot(, aes(x=1, y=2 + geom_point()
plot(best_summary_3s$bic, xlab = "Number of Variables", ylab = "BIC", type = "b")
data_frame(seq(length(best_summary_3s$bic)), best_summary_3s$bic) %>%
ggplot(aes(x=1, y=2)) + geom_point()
# Remove variables with direct linear dependencies
df_pred3 <- league_df %>%
select(-c(Season, Ht, `3P`, `3P%`, FG, FGA, `FG%`, `FT/FGA`, `eFG%`, `TS%`))
best_subsets_3s <- regsubsets(`3PA`~., df_pred3, method="backward")
best_summary_3s <- summary(best_subsets_3s)
plot(best_summary_3s$bic, xlab = "Number of Variables", ylab = "BIC", type = "b")
league_df
best_coefs <- coef(best_subsets_3s, 5)
coef_names <- names(best_coefs)
coef_names
model_3s <- lm(`3PA` ~ TRB+STL+TOV+PTS+`ORB%` , df_pred3)
summary(model_3s)
lm_defence <- lm(`3PA`~STL+TOV+BLK+DRB, league_df)
summary(model_3s)
geom_abline(model_3s)
# Remove variables with direct linear dependencies
df_pred3 <- league_df %>%
select(-c(Season, Ht, `3P`, `3P%`, FG, FGA, `FG%`, `FT/FGA`, `eFG%`, `TS%`))
best_subsets_3s <- regsubsets(`3PA`~., df_pred3, method="backward")
best_summary_3s <- summary(best_subsets_3s)
plot(best_summary_3s$bic, xlab = "Number of Variables", ylab = "BIC", type = "b")
df_pred3
knitr::opts_chunk$set(echo = FALSE)
# install.packages("MASS")
# install.packages("leaps")
library(MASS)
library(tidyverse)
library(leaps)
select <- dplyr::select
fitted(model_3s)
lm_defence <- lm(`3PA`~STL+TOV+BLK+DRB, league_df)
# summary(model_3s)
plot(league_df$Season, league_df$`3PA`, col="blue")
plot(league_df$Season, league_df$`3PA`, col="blue")
plot(league_df$Season, league_df$`3PA`, col="blue")
league_df$Season
df_3s$Season
lm_defence <- lm(`3PA`~STL+TOV+BLK+DRB, league_df)
# summary(model_3s)
plot(df_3s$Season, league_df$`3PA`, col="blue")
plot(df_3s$Season, ldf_3s$`3PA`, col="blue")
plot(df_3s$Season, df_3s$`3PA`, col="blue")
df_3s$`3PA`
df_3s$Season
plot(seq(length(df_3s$Season)), df_3s$`3PA`, col="blue")
lm_defence <- lm(`3PA`~STL+TOV+BLK+DRB, league_df)
# summary(model_3s)
plot(seq(length(df_3s$Season)), df_3s$`3PA`, col="blue")
lines(df_3s$Season, fit_3pa, col="green", lwd=2)
model_3s <- lm(`3PA` ~ TRB+STL+TOV+PTS+`ORB%` , df_pred3)
fit_3pa <-fitted(model_3s)
plot(df_3s$Season, df_3s$`3PA`)
plot(seq(length(df_3s$Season)), df_3s$`3PA`)
plot(seq(length(df_3s$Season)), df_3s$`3PA`)
plot(seq(length(df_3s$Season)), fitted_3PA)
model_3s <- lm(`3PA` ~ TRB+STL+TOV+PTS+`ORB%` , df_pred3)
fit_3pa <-fitted(model_3s)
plot(seq(length(df_3s$Season)), df_3s$`3PA`)
plot(seq(length(df_3s$Season)), fit_3PA)
model_3s <- lm(`3PA` ~ TRB+STL+TOV+PTS+`ORB%` , df_pred3)
fit_3PA <-fitted(model_3s)
plot(seq(length(df_3s$Season)), df_3s$`3PA`)
plot(seq(length(df_3s$Season)), fit_3PA)
model_3s <- lm(`3PA` ~ TRB+STL+TOV+PTS+`ORB%` , df_pred3)
fit_3PA <-fitted(model_3s)
plot(seq(length(df_3s$Season)), df_3s$`3PA`)
lines(seq(length(df_3s$Season)), fit_3PA)
